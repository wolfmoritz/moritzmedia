# Override from parent directory, everything in this directory and below is web accessible
Allow from all

# However, prevent direct directory access
Options -Indexes

<Files sitemap.xml>
  Header set X-Robots-Tag "noindex"
</Files>

RewriteEngine On

# Redirect from www subdomain to preferred domain (no-www), or otherway around as preferred
#RewriteCond %{HTTP_HOST} !^localhost$ [NC]
#RewriteCond %{HTTP_HOST} ^www [NC]
#RewriteRule ^(.*)$ https://<domain.topLevelDomain>/$1 [L,R=301]

# First check if this is a request for an asset file and if true, stop processing
RewriteCond %{REQUEST_URI} \.(jpe?g|png|gif|css|js|map|ico|txt|svg|woff)$ [NC]
RewriteRule ^ - [L]

# TEMPORARY COMING SOON LANDING PAGES FOR MORITZMEDIA AND PITONCMS
# moritzmedia.com → append /moritzmedia
# But ignore /login and /admin*
RewriteCond %{HTTP_HOST} ^(www\.)?moritzmedia\.com$ [NC]
RewriteCond %{REQUEST_URI} !^/index\.php [NC]
RewriteCond %{REQUEST_URI} !^/login [NC]
RewriteCond %{REQUEST_URI} !^/admin [NC]
RewriteRule ^(.*)$ moritzmedia/$1 [L]

# pitoncms.com → append /pitoncms
RewriteCond %{HTTP_HOST} ^(www\.)?pitoncms\.com$ [NC]
RewriteCond %{REQUEST_URI} !^/index\.php [NC]
RewriteRule ^(.*)$ pitoncms/$1 [L]

# Catch-all: everything else → index.php
RewriteCond %{REQUEST_URI} !^/index\.php [NC]
RewriteRule ^(.*)$ index.php/$1 [QSA,L]

# Caching
<IfModule mod_expires.c>
    ExpiresActive On
    ExpiresDefault "access plus 1 seconds"
    ExpiresByType image/x-icon "access plus 1 year"
    ExpiresByType image/jpeg "access plus 1 year"
    ExpiresByType image/png "access plus 1 year"
    ExpiresByType image/gif "access plus 1 year"
    ExpiresByType text/css "access plus 60 minutes"
    ExpiresByType text/javascript "access plus 60 minutes"
    ExpiresByType application/x-javascript "access plus 60 minutes"
    ExpiresByType text/html "access plus 60 seconds"
</IfModule>

<ifModule mod_headers.c>
  <filesMatch "\.(ico|jpe?g|png|gif|css|woff|txt)$">
    Header set Cache-Control "public"
  </filesMatch>
  <filesMatch "\.(js)$">
    Header set Cache-Control "private"
  </filesMatch>
</ifModule>
